meta:
  name: deeplint-package-aws-s3publicbucket
  author: DeepLint(dev@deeplint.com)
  description: Package to find and fix problems for AWS S3
  packageFormatVersion: 1.0.0

inputs:
  buckets:
    description: S3 buckets name regex for buckets to check
    type: String
    default: ".*"
  regions:
    description: AWS Regions
    type: String
    default: "['us-east-1']"
scanners:
  aws-s3-scanner:
    type: nodejs
    uses: "@deeplint/deepscanner-aws"
    main: scan
    with:
      services: ["S3"]
      regions: {{regions}}
rules:
  is-bucket-public:
    type: nodejs
    uses: "./src/rules/is-bucket-public.js"
    main: check
    with:
      buckets: {{buckets}}
    meta:
      type: "warn"
      description: "Check whether S3 Bucket server side encryption is enabled"
      tags:
        - "S3"

#actions:
#  dummy-fix:
#    type: nodejs
#    uses: src/dummy-fix-1.js
#    main: update
#    with:


